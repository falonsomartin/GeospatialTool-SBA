(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,a){},158:function(e,t){},232:function(e,t,a){e.exports=a(360)},251:function(e,t,a){},252:function(e,t,a){},259:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},354:function(e,t){},360:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),i=a.n(o),l=a(208),s=a(76),c=a(14),d=a(13),p=a(21),u=a(20),m=a(22),h=a(118),g=a(416),f=new(a(157).EventEmitter),v=(a(251),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={key:null},a.handleCloseClick=function(e){a.props.closeSnackbar(e)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{className:"snackbar-btn white-text",onClick:e.handleCloseClick.bind(e,t)},"DISMISS"))};this.showSnackbarListener=f.addListener("showSnackbar",function(a,n){console.log(n),e.props.enqueueSnackbar(n,{variant:a,autoHideDuration:3e3,action:t})}),this.showloggingSnackbarListener=f.addListener("showloggingSnackbar",function(t){var a="Logging to ".concat(t,"..."),n=e.props.enqueueSnackbar(a,{variant:"info",persist:!0});e.setState({key:n})}),this.hideloggingSnackbarListener=f.addListener("hideloggingSnackbar",function(){e.props.closeSnackbar(e.state.key)})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.showSnackbarListener),f.removeListener(this.showloggingSnackbarListener),f.removeListener(this.hideloggingSnackbarListener)}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(r.a.Component)),y=Object(h.withSnackbar)(v),b=a(71),x=a.n(b),E={root:{position:"fixed",top:0,zIndex:900},logoContainer:{height:"60px"},logo:{height:"55px"},flexContainer:{position:"absolute",right:12,display:"flex",flexDirection:"row-reverse",justifyContent:"flex-start"},svgIcon:{width:24,height:24},fontIcon:{fontSize:29},toolbar:{background:"#89ca92"}},C=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={modal:null},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("about"),a=x.a.Modal.init(t);e.setState({modal:a})})}},{key:"componentWillUnmount",value:function(){this.state.modal.destory()}},{key:"render",value:function(){return r.a.createElement("div",{id:"about",className:"modal"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("h4",null,"About"),r.a.createElement("p",null,"Designed & Written by\xa0",r.a.createElement("a",{href:"https://evenor-tech.com/"},"Evenor-Tech"),"."),r.a.createElement("p",null,r.a.createElement("a",{style:E.logoContainer,href:"https://www.steambioafrica.com/"},r.a.createElement("img",{style:E.logo,src:"./static/assets/eu.png",alt:""})))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{className:"modal-close waves-effect waves-light btn-flat"},"OK")))}}]),t}(r.a.Component),w=a(417),S=a(418),k=a(364),L=a(212),I=a(419),O=a(79),j=a(415),D=a(191),T=a.n(D),R=Object(O.b)({palette:{primary:{main:T.a[900]}}}),P={root:{position:"fixed",top:0,zIndex:900},logoContainer:{height:"60px"},logo:{height:"55px"},flexContainer:{position:"absolute",right:12,display:"flex",flexDirection:"row-reverse",justifyContent:"flex-start"},svgIcon:{width:24,height:24},fontIcon:{fontSize:29},toolbar:{background:"#89ca92"}},B=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loggedin:!1,token:null},a.handleLoginClick=function(){f.emit("login")},a.handleLogoutClick=function(){f.emit("removeAllLayer"),f.emit("removeDataset"),f.emit("removeAllDataset"),f.emit("handleDatasetRemove"),localStorage.removeItem("token"),localStorage.removeItem("jwt"),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),f.emit("showSnackbar","success","Logout successfully."),a.setState({token:null,loggedin:!1})},a.handleToken=function(e){console.log("Received token:",e),a.setState({token:e})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setLoginStateListener=f.addListener("setLoginState",function(t){e.setState({loggedin:t})}),f.on("handleToken",this.handleToken)}},{key:"componentWillUnmount",value:function(){f.removeListener(this.setLoginStateListener)}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:R},r.a.createElement(w.a,{style:P.root,position:"static"},r.a.createElement(S.a,{style:P.toolbar},r.a.createElement("a",{style:P.logoContainer,href:"https://evenor-tech.com/"},r.a.createElement("img",{style:P.logo,src:"./static/assets/logo.png",alt:""})),"\xa0 \xa0 \xa0 \xa0",r.a.createElement("a",{style:P.logoContainer,href:"https://www.steambioafrica.com/"},r.a.createElement("img",{style:P.logo,src:"./static/assets/bioafrica.png",alt:""})),r.a.createElement("div",{style:P.flexContainer},r.a.createElement(k.a,{title:"About","aria-label":"About",enterDelay:200},r.a.createElement(L.a,{className:"icon-container modal-trigger","aria-label":"About",color:"inherit","data-target":"about"},r.a.createElement(I.a,{style:P.fontIcon},"info_outline")))))))}}]),t}(r.a.Component),_=a(450),A=a(451),F=a(420),M=(a(252),{root:{position:"fixed",right:24,bottom:24,zIndex:1e3}}),N=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,actions:[{name:"Switch style",icon:r.a.createElement(I.a,null,"brush"),color:"red accent-2",callback:function(){f.emit("closeAllController"),f.emit("openStyleController"),a.handleClose()}},{name:"Spatiotemporal Analysis",icon:r.a.createElement(I.a,null,"satellite_alt"),color:"orange",callback:function(){f.emit("closeAllController"),f.emit("openSpatioTemporalAnalysisController"),a.handleClose()}},{name:"Vegetation Index Change Inspector",icon:r.a.createElement(I.a,null,"image_search"),color:"blue",callback:function(){f.emit("closeAllController"),f.emit("openVegInspectorController"),a.handleClose()}},{name:"Rusle Modelling",icon:r.a.createElement(I.a,null,"grass"),color:"green",callback:function(){f.emit("closeAllController"),f.emit("openRusleController"),a.handleClose()}},{name:"SOC Prediction",icon:r.a.createElement(I.a,null,"psychology"),color:"purple darken-1",callback:function(){f.emit("closeAllController"),f.emit("openSocController"),a.handleClose()}},{name:"Configure layers",icon:r.a.createElement(I.a,null,"layers"),color:"yellow darken-1",callback:function(){f.emit("closeAllController"),f.emit("openLayerController"),a.handleClose()}}]},a.handleClick=function(){a.setState(function(e){return{open:!e.open}})},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.openMenuListener=f.addListener("openMenu",function(){e.setState({open:!0})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openMenuListener)}},{key:"render",value:function(){return r.a.createElement(_.a,{style:M.root,open:this.state.open,ariaLabel:"Menu",icon:r.a.createElement(A.a,{icon:r.a.createElement(I.a,null,"menu"),openIcon:r.a.createElement(I.a,null,"clear")}),onMouseEnter:this.handleOpen,onMouseLeave:this.handleClose,onClick:this.handleClick},this.state.actions.map(function(e){return r.a.createElement(F.a,{key:e.name,className:e.color,icon:e.icon,tooltipTitle:e.name,onClick:e.callback})}))}}]),t}(r.a.Component),U=a(8),z=a.n(U),W=a(18),H=a(193),V=a.n(H),q=a(447),Z=a(426),G=a(421),J=a(173),Q=a(452),$=a(106),K=a(54),Y=a.n(K),X=a(443),ee=a(158),te=a.n(ee),ae=a(442);ae.a.defaults.baseURL="http://localhost:5000",ae.a.defaults.withCredentials=!0;var ne=Object(O.b)({palette:{primary:{main:Y.a.A200}}}),re=["41046A010000100000DU","41041A014001860000HF","41041A014001790000HQ","41041A015002920000HF","41041A015002760000HH","41041A015002730000HS","41041A014000920000HF","41041A007003790000HK","41041A005000430000HO"];ae.a.interceptors.request.use(function(e){var t=new URL(e.url).origin,a=["http://localhost:5000"],n=localStorage.getItem("token");return a.includes(t)&&(e.headers.authorization="Bearer ".concat(n)),e},function(e){return Promise.reject(e)});var oe={loginContainer:{width:300,height:350,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},title:{marginBottom:20},inputBox:{width:240,marginTop:15},autocomplete:{width:240,display:"flex",flexWrap:"wrap",overflow:"auto"},checkBox:{width:140},loginBtnContainer:{display:"inline-block",position:"relative"},loginBtn:{width:120,marginTop:20},loginBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-3,marginLeft:-12}},ie=r.a.forwardRef(function(e,t){return r.a.createElement(J.a,Object.assign({direction:"down",ref:t},e))}),le=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,remember:!1,logining:!1,mode:"login",selectedOptions:[],datasets:{}},a.handleLoginClose=function(){a.setState({open:!1})},a.handleRememberChange=function(e){a.setState({remember:e.target.checked})},a.handleChangeForm=function(e){a.setState({mode:"login"===a.state.mode?"Login":"Register"}),console.log(a.state.mode)},a.handleChangeAutoComplete=function(e,t){var n=t.map(function(e){return e.reference});a.setState({selectedOptions:n},function(){console.log(a.state.selectedOptions)})},a.getUserParcels=function(){var e=Object(W.a)(z.a.mark(function e(t){var n;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("http://localhost:5000/users/".concat(t,"/parcels"));case 3:200===(n=e.sent).status?(a.updateDatasetUtilsFile(n.data),console.log("Parcelas recibidas:",n.data)):console.error("No se pudieron obtener las parcelas:",n.statusText),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error al obtener las parcelas:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.handleLoginClick=Object(W.a)(z.a.mark(function e(){var t,n,r,o;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({logining:!0}),t={username:document.getElementById("username").value,password:V()(document.getElementById("password").value)},e.next=4,ae.a.post("http://localhost:5000/login",t);case 4:200===(n=e.sent).status&&(r=n.data.message[0],o=n.data.message[1],f.emit("handleToken",o),localStorage.removeItem("token"),localStorage.removeItem("jwt"),localStorage.setItem("token",o),f.emit("showSnackbar","success","User login successfully."),f.emit("setLoginState",!0),a.getUserParcels(r),a.setState({open:!1,logining:!1,idUser:r}),console.log(localStorage.getItem("token")));case 6:case"end":return e.stop()}},e)})),a.moveDataset=function(){var e=a.state.datasets;a.setState({movedData:e}),console.log(a.state.movedData)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"updateDatasetUtilsFile",value:function(e){e.forEach(function(e){te.a[e.catastral_ref]={data:e.geojson_data}}),this.setState({datasets:te.a}),console.log("Updated datasets:",this.state.datasets),f.emit("moveDataset",this.state.datasets)}},{key:"componentDidMount",value:function(){var e=this;this.loginListener=f.addListener("login",function(){e.setState({open:!0})}),this.moveDatasetListener=f.addListener("moveDataset",function(){e.moveDataset()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.loginListener),f.removeListener(this.moveDatasetListener)}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:ne},r.a.createElement(G.a,{open:this.state.open,TransitionComponent:ie,onClose:this.handleLoginClose},r.a.createElement("div",{style:oe.loginContainer},"login"===this.state.mode?r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{style:oe.title,variant:"h5",gutterBottom:!0},"Inicio de Sesi\xf3n"),r.a.createElement(Q.a,{style:oe.inputBox,variant:"outlined",margin:"dense",id:"username",label:"Usuario"}),r.a.createElement(Q.a,{style:oe.inputBox,variant:"outlined",margin:"dense",id:"password",type:"password",label:"Contrase\xf1a"})):r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{style:oe.title,variant:"h5",gutterBottom:!0},"Registro"),r.a.createElement(Q.a,{style:oe.inputBox,variant:"outlined",margin:"dense",id:"username",label:"Usuario"}),r.a.createElement(Q.a,{style:oe.inputBox,variant:"outlined",margin:"dense",id:"password",type:"password",label:"Contrase\xf1a"}),r.a.createElement(X.a,{style:oe.inputBox,multiple:!0,onChange:this.handleChangeAutoComplete,limitTags:1,id:"checkboxes-tags-demo",options:re,getOptionLabel:function(e){return e},renderOption:function(e,t){var a=t.selected;return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,{style:{marginRight:1,marginLeft:1},checked:a}),e)},renderInput:function(e){return r.a.createElement(Q.a,Object.assign({id:"lista"},e,{variant:"outlined",label:"Checkboxes",placeholder:"Favorites"}))},renderTags:function(){return null}})),r.a.createElement("div",{style:oe.loginBtnContainer},r.a.createElement(g.a,{style:oe.loginBtn,variant:"contained",color:"primary",disabled:this.state.logining,onClick:this.handleLoginClick},"INICIAR SESI\xd3N"),this.state.logining&&r.a.createElement(Z.a,{style:oe.loginBtnProgress,size:24}),r.a.createElement(g.a,{style:oe.loginBtn,onClick:this.handleChangeForm,color:"primary"},"login"===this.state.mode?"Register":"Login")))))}}]),t}(r.a.Component),se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={tapTarget:null},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("DOMContentLoaded",function(){document.getElementsByClassName("MuiSpeedDial-fab")[0].setAttribute("id","menu");var t=document.querySelectorAll(".tap-target"),a=x.a.TapTarget.init(t)[0];a.open(),e.setState({tapTarget:a})})}},{key:"componentWillUnmount",value:function(){this.state.tapTarget.destory()}},{key:"render",value:function(){return r.a.createElement("div",{className:"tap-target indigo accent-2","data-target":"menu"},r.a.createElement("div",{className:"tap-target-content white-text"},r.a.createElement("h5",null,"Welcome to TERRENVIRON!"),r.a.createElement("p",null,"This is the geospatial tool developed for the enviromental monitoring for shurblands and savannah in Southern Africa.")))}}]),t}(r.a.Component),ce=a(427),de=a(428),pe=a(429),ue={Streets:"mapbox://styles/mapbox/streets-v11",Light:"mapbox://styles/mapbox/light-v10",Dark:"mapbox://styles/mapbox/dark-v10",Navigation:"mapbox://styles/mapbox/navigation-night-v1"},me=(a(259),{root:{position:"fixed",top:74,right:10,borderRadius:4,width:320,margin:0,zIndex:900},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},stylePreview:{width:60,height:60,borderRadius:2,cursor:"pointer"}}),he=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleStyleClick=function(e){f.emit("setMapStyle",e),a.handleCloseClick()},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.openStyleControllerListener=f.addListener("openStyleController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openStyleControllerListener),f.removeListener(this.closeAllControllerListener)}},{key:"render",value:function(){var e=this;return r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:me.root},r.a.createElement(de.a,{style:me.header},r.a.createElement($.a,{gutterBottom:!0,variant:"h5",component:"h2"},"Map Styles"),r.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Click to choose a map style"),r.a.createElement(L.a,{style:me.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),r.a.createElement(de.a,null,r.a.createElement(pe.a,{container:!0,spacing:2},Object.keys(ue).map(function(t,a){return console.log(t),r.a.createElement(pe.a,{item:!0,style:me.styleCard,key:a,xs:3},r.a.createElement("img",{src:"./static/assets/".concat(t,".png"),alt:"",className:"hoverable",style:me.stylePreview,onClick:e.handleStyleClick.bind(e,t)}))})))))}}]),t}(r.a.Component),ge=a(100),fe=a(28),ve=a(32),ye=a(453),be=a(424),xe=a(455),Ee=a(445),Ce=a(430),we=a(425),Se=a(369),ke=a(431),Le=Object(O.b)({typography:{fontFamily:"Lato, Arial, sans-serif"},overrides:{MuiCssBaseline:{"@global":{body:{fontFamily:"Lato, Arial, sans-serif"}}}}}),Ie={root:{position:"fixed",top:74,right:10,width:300,borderRadius:9,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},header:{backgroundColor:"rgb(138, 213, 137)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},content:{paddingBottom:16},select:{width:"100%"},layerList:{marginTop:6,paddingBottom:0},layerItem:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:2,paddingRight:5},layerText:{flexGrow:1,maxWidth:"120px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},checkbox:{marginRight:"8px"},slider:{width:"80px",marginLeft:"10px"}},Oe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,mapp:null,selected:{},resolution:7,zoom:0,layerForm:"Border",datasets:{},layers:[],assets:[],selectedAsset:"",mapUrl:""},a.handleCloseClick=function(){a.setState({open:!1})},a.truncateLayerName=function(e){return e.length>13?e.substring(0,10)+"...":e},a.handleDatasetChange=function(){var e=Object(W.a)(z.a.mark(function e(t){var n,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,Object.keys(a.state.selected).map(function(e){return n=!0,a.setState({selected:{}}),!0}),!n&&t.target.value.length&&(r=t.target.value[t.target.value.length-1],f.emit("showSnackbar","default","Downloading dataset '".concat(r,"'.")),f.emit("displayDataset",r,a.state.datasets[r].data,"#f08"),f.emit("showSnackbar","success","Dataset '".concat(r,"' downloaded successfully.")));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleShapeChange=function(e){a.setState({shape:e.target.value})},a.handleLayerVisibilityChange=function(e){var t=a.state.layers.map(function(t){return t.id===e?Object(ve.a)({},t,{visible:!t.visible}):t});a.setState({layers:t}),f.emit("toggleLayerVisibility",e,t.find(function(t){return t.id===e}).visible)},a.handleTransparencyChange=function(e,t){var n=a.state.layers.map(function(a){return a.id===e?Object(ve.a)({},a,{transparency:t}):a});a.setState({layers:n}),f.emit("changeLayerTransparency",e,t/100)},a.splitAssetName=function(e){var t=e.split("/"),a=t[t.length-1];return a.startsWith("0")&&(a=a.substring(1)),a},a.handleDrop=function(e){e.preventDefault();var t=e.dataTransfer.files;if(t.length>0){var n=t[0],r=new FileReader;r.onload=function(e){var t=JSON.parse(e.target.result),r={id:n.name,visible:!0,transparency:100};a.setState(function(e){return{datasets:Object(ve.a)({},e.datasets,Object(fe.a)({},n.name,{data:t})),layers:[].concat(Object(ge.a)(e.layers),[r])}}),f.emit("displayDataset",n.name,t),f.emit("showSnackbar","success","Dataset '".concat(n.name,"' added as a layer successfully."))},r.readAsText(n)}},a.fetchAssets=Object(W.a)(z.a.mark(function e(){var t,n;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5004/list-assets");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,console.log(n.assets),a.setState({assets:n.assets}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching assets:",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])})),a.fetchMapUrl=function(){var e=Object(W.a)(z.a.mark(function e(t,n){var r,o;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5004/get-map-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({asset_id:t,asset_type:n})});case 3:return r=e.sent,e.next=6,r.json();case 6:o=e.sent,console.log(o),a.setState({mapUrl:o.map_url}),f.emit("moveURL",[o.map_url,t]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error fetching map URL:",e.t0);case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleAssetChange=function(e){var t=e.target.value.id,n=e.target.value.type;a.setState({selectedAsset:t,selectedAssetType:n}),a.fetchMapUrl(t,n)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchAssets(),this.openLayerControllerListener=f.addListener("openLayerController",function(){e.setState({open:!0})}),this.newLayerListener=f.addListener("newLayer",function(t){e.setState(function(e){return{layers:[].concat(Object(ge.a)(e.layers),[t])}})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.setMapZoomListener=f.addListener("setMapZoom",function(t){e.setState({zoom:t})}),this.handleDatasetRemoveListener=f.addListener("handleDatasetRemove",function(){e.handleDatasetRemove()}),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}},{key:"componentDidUpdate",value:function(e){this.props.map!==e.map&&this.updateDatasets()}},{key:"handleDatasetRemove",value:function(){this.setState({datasets:{},selected:{}})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openLayerControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.setMapZoomListener),f.removeListener(this.handleDatasetRemoveListener),f.removeListener(this.newLayerListener),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){var e=this;return console.log(this.state.layers),r.a.createElement(j.a,{theme:Le},r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:Ie.root},r.a.createElement(de.a,{style:Ie.header},r.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Layers"),r.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Manage and control layers"),r.a.createElement(L.a,{style:Ie.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),r.a.createElement(de.a,{style:Ie.content},r.a.createElement(be.a,{style:Ie.select},r.a.createElement(xe.a,null,"Assets"),r.a.createElement(Ee.a,{value:this.state.selectedAsset,onChange:this.handleAssetChange},this.state.assets.map(function(t){return r.a.createElement(Ce.a,{key:t.id,value:{id:t.id,type:t.type}},e.splitAssetName(t.id))}))),r.a.createElement(we.a,{id:"layers",style:Ie.layerList},this.state.layers.map(function(t){return r.a.createElement(Se.a,{style:Ie.layerItem,key:t.id},r.a.createElement(ke.a,{primary:r.a.createElement("span",{style:Ie.layerText},r.a.createElement(k.a,{title:e.splitAssetName(t.id),sx:{fontSize:"1.2rem"}},r.a.createElement("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"block"}},e.truncateLayerName(e.splitAssetName(t.id)))))}),r.a.createElement(q.a,{checked:t.visible,onChange:function(){return e.handleLayerVisibilityChange(t.id)},color:"primary"}),r.a.createElement(ye.a,{value:t.transparency,onChange:function(a,n){return e.handleTransparencyChange(t.id,n)},min:0,max:100,style:{width:"100px"}}))}))))))}}]),t}(r.a.Component),je=a(194),De=a.n(je),Te=(a(307),a(195)),Re=a.n(Te),Pe=a(196),Be=a.n(Pe),_e=a(48),Ae=a.n(_e),Fe=function(e){var t=e.match(/^[ ]*(?:Lat: )?(-?\d+\.?\d*)[, ]+(?:Lng: )?(-?\d+\.?\d*)[ ]*$/i);if(!t)return null;var a=function(e,t){return{center:[e,t],geometry:{type:"Point",coordinates:[e,t]},place_name:"Lat: "+t+" Lng: "+e,place_type:["coordinate"],properties:{},type:"Feature"}},n=Number(t[1]),r=Number(t[2]),o=[];return(n<-90||n>90)&&o.push(a(n,r)),(r<-90||r>90)&&o.push(a(r,n)),0===o.length&&(o.push(a(n,r)),o.push(a(r,n))),o},Me={width:200,height:200,data:new Uint8Array(16e4),onAdd:function(e){var t=document.createElement("canvas");t.width=this.width,t.height=this.height,this.context=t.getContext("2d"),this.map=e},render:function(){var e=this.context,t=performance.now()%1e3/1e3;return e.clearRect(0,0,this.width,this.height),e.beginPath(),e.arc(this.width/2,this.height/2,70*t+30,0,2*Math.PI),e.fillStyle="rgba(200, 200, 255,"+(1-t)+")",e.fill(),e.beginPath(),e.arc(this.width/2,this.height/2,30,0,2*Math.PI),e.fillStyle="rgba(100, 100, 255, 1)",e.strokeStyle="white",e.lineWidth=2+4*(1-t),e.fill(),e.stroke(),this.data=e.getImageData(0,0,this.width,this.height).data,this.map.triggerRepaint(),!0}};function Ne(e){Object.assign(this.options,e),this._ticking=!1,this._lastMouseMoveEvent=null,this._parentMap=null,this._isDragging=!1,this._isCursorOverFeature=!1,this._previousPoint=[0,0],this._currentPoint=[0,0],this._trackingRectCoordinates=[[[],[],[],[],[]]]}Ne.prototype=Object.assign({},Ae.a.NavigationControl.prototype,{options:{style:"mapbox://styles/almafe2510/clw7qv6il02ok01qr9w4wdbv0",center:[0,0]},onAdd:function(e){return this._container=this._createContainer(e),this._parentMap=e,this._miniMap=new Ae.a.Map({attributionControl:!1,container:this._container,style:this.options.style,center:this.options.center,zoom:0}),this._miniMap.on("load",this._load.bind(this)),this._container},_createContainer:function(e){var t=document.createElement("div");return t.id="minimap",t.className="mapboxgl-ctrl mapboxgl-ctrl-minimap",t.addEventListener("contextmenu",this._preventDefault),e.getContainer().appendChild(t),t},_preventDefault:function(e){e.preventDefault()},_load:function(){var e=this;this._zoomAdjust(),["dragPan","boxZoom","dragRotate","keyboard","doubleClickZoom","touchZoomRotate"].map(function(t){return e._miniMap[t].disable(),!0});var t=this._miniMap.getBounds();this._convertBoundsToPoints(t),this._miniMap.addSource("trackingRect",{type:"geojson",data:{type:"Feature",properties:{name:"trackingRect"},geometry:{type:"Polygon",coordinates:this._trackingRectCoordinates}}}),this._miniMap.addLayer({id:"trackingRectOutline",type:"line",source:"trackingRect",layout:{},paint:{"line-color":"#08F","line-width":1,"line-opacity":1}}),this._miniMap.addLayer({id:"trackingRectFill",type:"fill",source:"trackingRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.25}}),this._trackingRect=this._miniMap.getSource("trackingRect"),this._parentMap.on("move",this._update.bind(this)),this._parentMap.on("zoom",this._zoomAdjust.bind(this)),this._miniMap.on("mousemove",this._mouseMove.bind(this)),this._miniMap.on("mousedown",this._mouseDown.bind(this)),this._miniMap.on("mouseup",this._mouseUp.bind(this)),this._miniMap.on("touchmove",this._mouseMove.bind(this)),this._miniMap.on("touchstart",this._mouseDown.bind(this)),this._miniMap.on("touchend",this._mouseUp.bind(this)),this._miniMapCanvas=this._miniMap.getCanvasContainer(),this._miniMapCanvas.addEventListener("wheel",this._preventDefault),this._miniMapCanvas.addEventListener("mousewheel",this._preventDefault),this._update()},_mouseDown:function(e){this._isCursorOverFeature&&(this._isDragging=!0,this._previousPoint=this._currentPoint,this._currentPoint=[e.lngLat.lng,e.lngLat.lat])},_mouseUp:function(){this._isDragging=!1,this._ticking=!1},_mouseMove:function(e){this._ticking=!1;var t=this._miniMap.queryRenderedFeatures(e.point,{layers:["trackingRectFill"]});if((!this._isCursorOverFeature||t.length<=0)&&(this._isCursorOverFeature=t.length>0,this._miniMapCanvas.style.cursor=this._isCursorOverFeature?"move":""),this._isDragging){this._previousPoint=this._currentPoint,this._currentPoint=[e.lngLat.lng,e.lngLat.lat];var a=[this._currentPoint[0]-this._previousPoint[0],this._currentPoint[1]-this._previousPoint[1]],n=this._moveTrackingRect(a);this._parentMap.fitBounds(n,{duration:80,noMoveStart:!0})}},_moveTrackingRect:function(e){var t=this._trackingRect._data.properties.bounds;return t._ne.lng+=e[0],t._ne.lat+=e[1],t._sw.lng+=e[0],t._sw.lat+=e[1],this._convertBoundsToPoints(t),this._trackingRect.setData(this._trackingRect._data),t},_setTrackingRectBounds:function(e){this._convertBoundsToPoints(e),this._trackingRect._data.properties.bounds=e,this._trackingRect.setData(this._trackingRect._data)},_convertBoundsToPoints:function(e){this._trackingRectCoordinates[0][0][0]=e._ne.lng,this._trackingRectCoordinates[0][0][1]=e._ne.lat,this._trackingRectCoordinates[0][1][0]=e._sw.lng,this._trackingRectCoordinates[0][1][1]=e._ne.lat,this._trackingRectCoordinates[0][2][0]=e._sw.lng,this._trackingRectCoordinates[0][2][1]=e._sw.lat,this._trackingRectCoordinates[0][3][0]=e._ne.lng,this._trackingRectCoordinates[0][3][1]=e._sw.lat,this._trackingRectCoordinates[0][4][0]=e._ne.lng,this._trackingRectCoordinates[0][4][1]=e._ne.lat},_update:function(){if(!this._isDragging){var e=this._parentMap.getBounds();this._setTrackingRectBounds(e)}},_zoomAdjust:function(){var e=parseInt(this._parentMap.getZoom());this._miniMap.flyTo({center:this._parentMap.getCenter(),zoom:e<4?0:e-3,bearing:0})}});var Ue=Ne,ze="pk.eyJ1IjoiZ2Fydm94IiwiYSI6ImNseHZucnRpcDB4Y3EycXNkNjRuM3drNWsifQ.V5lH9roOpH9a6Jphwybprw",We=(a(336),{root:{width:"100%",position:"fixed",top:64,bottom:0}}),He=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(p.a)(this,Object(u.a)(t).call(this,e))).removeTempLayer=function(){var e=a.state.map.getStyle().layers;a.setState({map:null}),e.map(function(e){return"custom-temp-point"===e.id&&(a.state.map.removeLayer("custom-temp-point"),a.state.map.removeSource("custom-temp-point")),!0}),a.state.popup&&a.state.popup.isOpen()&&a.state.popup.remove()},a.removeAllLayer=function(){var e=a.state.map.getStyle().layers;e.map(function(e){return e.id.includes("-points")&&(a.state.map.removeLayer(e.id),a.state.map.removeSource(e.source)),!0}),e.map(function(e){return e.id.includes("-boundary")&&(a.state.map.removeLayer(e.id),a.state.map.removeSource(e.source)),!0}),a.state.popup&&a.state.popup.isOpen()&&a.state.popup.remove(),f.emit("handleDatasetRemove")},a.add3dLayer=function(){var e=a.state.map.getStyle().layers;for(var t in e)if("symbol"===t.type&&t.layout["text-field"]){var n=t.id;break}a.state.map.getLayer("3d-buildings")?a.state.map.moveLayer("3d-buildings",n):a.state.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:12,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},n)},a.removeTempPoint=function(){a.state.draw.delete(a.state.tempId),a.setState({tempId:null})},a.handleURLMoved=function(e){console.log("Received moved data:",e),a.setState({url:e[0][0]}),f.emit("newLayer",{id:e[0][1],url:e[0][0],visible:!0,transparency:100}),console.log(e),a.state.map.addLayer({id:e[0][1],type:"raster",source:{type:"raster",tiles:[a.state.url],tileSize:256},paint:{"raster-opacity":.8}}),console.log(a.state.url)},a.mapContainer=r.a.createRef(),a.state={map:null,draw:null,minimap:null,popup:null,gettingPoint:null,tempId:null,styleCode:Object.values(ue)[1].substring(16)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"flyToGeometry",value:function(e,t){var a,n=t.type;"FeatureCollection"===n?a=t.features[0].geometry.coordinates:a="Feature"===n?t.geometry.coordinates:t.coordinates;"Polygon"===t.features[0].geometry.type?this.state.map.flyTo({center:a[0][0],zoom:15}):"Point"===t.features[0].geometry.type&&this.state.map.flyTo({center:a,zoom:17})}},{key:"componentDidMount",value:function(){var e=this;if(Ae.a.accessToken=ze,Ae.a.supported()){var t=new Ae.a.Map({container:this.mapContainer.current,style:Object.values(ue)[0],center:[-6.002481,37.377469],zoom:10,antialias:!0}),a=new De.a({controls:{combine_features:!1,uncombine_features:!1}}),n=new Ue({center:t.getCenter(),style:Object.values(ue)[0]});t.addControl(new Re.a({accessToken:Ae.a.accessToken,mapboxgl:Ae.a,localGeocoder:Fe,placeholder:"Search Address",marker:{color:"red"}}),"top-left"),t.addControl(new Ae.a.NavigationControl,"top-left"),t.addControl(new Ae.a.GeolocateControl,"top-left"),t.addControl(new Be.a({trafficSource:new RegExp("/*/")}),"top-left"),t.addControl(a,"top-left"),t.addControl(n,"bottom-left");var r=new Ae.a.Popup({closeButton:!1,anchor:"bottom"}).setHTML('<div id="popup-container"></div>');document.getElementsByClassName("mapboxgl-ctrl-geocoder--input")[0].setAttribute("type","search-box"),t.on("load",function(){e.add3dLayer(),document.getElementById("loader-wrapper").classList.add("loaded")}),t.on("zoomend",function(){var e=t.getZoom();f.emit("setMapZoom",e)}),t.on("draw.create",function(t){e.state.gettingPoint&&(e.setState({tempId:t.features[0].id}),f.emit("setPoint",t.features[0],e.state.styleCode,e.state.map.getZoom()),e.setState({gettingPoint:!1}))}),this.setMapStyleListener=f.addListener("setMapStyle",function(t){e.state.popup.isOpen()&&e.state.popup.remove(),e.state.map.setStyle(ue[t]);var a=new Ue({center:e.state.map.getCenter(),style:ue[t]});e.state.map.removeControl(e.state.minimap),e.state.map.addControl(a,"bottom-left"),e.setState({minimap:a,styleCode:ue[t].substring(16)})}),this.toggleLayerVisibilityListener=f.addListener("toggleLayerVisibility",function(t,a){e.state.map.getLayer(t)&&e.state.map.setLayoutProperty(t,"visibility",a?"visible":"none")}),this.changeLayerTransparencyListener=f.addListener("changeLayerTransparency",function(t,a){e.state.map.getLayer(t)&&e.state.map.setPaintProperty(t,"raster-opacity",a)}),this.displayDatasetListener=f.addListener("displayDataset",function(a,n){e.state.map.getSource(a)&&e.state.map.removeSource(a),t.addSource(a,{type:"geojson",data:n}),t.addLayer({id:a+"-boundary",type:"fill",source:a,paint:{"fill-color":"#888888","fill-opacity":.4},filter:["==","$type","Polygon"]}),t.addLayer({id:a+"-points",type:"circle",source:a,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]}),e.flyToGeometry(t,n)}),this.removeDatasetListener=f.addListener("removeDataset",function(t){[t+"-boundary",t+"-points"].forEach(function(t){e.state.map.getLayer(t)&&e.state.map.removeLayer(t)}),e.state.map.getSource(t)&&e.state.map.removeSource(t)}),this.displayTempLayerListener=f.addListener("displayTempLayer",function(t){e.removeTempLayer(),e.state.map.hasImage("marker")||e.state.map.addImage("marker",Me,{pixelRatio:3}),e.state.map.addLayer({id:"custom-temp-point",type:"symbol",source:{type:"geojson",data:t.geometry},layout:{"icon-image":"marker"}}),e.state.popup.setLngLat(t.geometry.geometry.coordinates).addTo(e.state.map),f.emit("bindPopup",t),e.state.map.flyTo({center:t.geometry.geometry.coordinates,zoom:6,bearing:0})}),this.setState({map:t,draw:a,minimap:n,popup:r}),f.on("moveURL",this.handleURLMoved)}else alert("Your browser does not support Mapbox GL")}},{key:"componentWillUnmount",value:function(){f.removeListener(this.setMapStyleListener),f.removeListener(this.displayDatasetListener),f.removeListener(this.removeDatasetListener),f.removeListener(this.displayTempLayerListener),f.removeListener(this.toggleLayerVisibilityListener),f.removeListener(this.changeLayerTransparencyListener)}},{key:"render",value:function(){return r.a.createElement("div",{id:"map",style:We.root,ref:this.mapContainer})}}]),t}(r.a.Component),Ve=a(432),qe={root:{minWidth:320,maxWidth:345},image:{height:140},titleContainer:{display:"flex",alignItems:"space-between",padding:"5px 16px 2px"},titleContainerEnd:{display:"flex",alignItems:"space-between",padding:"5px 16px 10px"},nameContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-end",height:65},popupName:{display:"inline-block"},popupPinyin:{display:"inline-block"},weatherWidgetContainer:{position:"absolute",right:0,width:155},introductionContainer:{paddingTop:5},popupIntroduction:{wordWrap:"break-word",wordBreak:"break-all"}},Ze=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,data:{}},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.bindPopupListener=f.addListener("bindPopup",function(t){var a=document.getElementById("popup");document.getElementById("popup-container").appendChild(a);var n=document.createElement("script");n.type="text/javascript",n.src="https://darksky.net/widget/default-small/".concat(t.geometry.geometry.coordinates[1].toString(),",").concat(t.geometry.geometry.coordinates[0].toString(),"/ca12/en.js?height=60"),document.getElementById("customize-script-container").appendChild(n),e.setState({open:!0,data:t})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.bindPopupListener)}},{key:"render",value:function(){return r.a.createElement(ce.a,{id:"popup",style:qe.root,className:this.state.open?null:"hidden"},r.a.createElement(Ve.a,{className:this.state.data.image&&this.state.data.image.src?null:"hidden",style:qe.image,image:this.state.data.image&&this.state.data.image.src?this.state.data.image.src:"#"}),r.a.createElement(de.a,{style:this.state.data.introduction?qe.titleContainer:qe.titleContainerEnd},r.a.createElement("div",{style:qe.nameContainer},r.a.createElement($.a,{style:qe.popupName,variant:"h5",component:"h2"},this.state.data.name),r.a.createElement($.a,{style:qe.popupPinyin,variant:"subtitle1",color:"textSecondary",component:"h3"},this.state.data.pinyin)),r.a.createElement("div",{id:"customize-script-container",style:qe.weatherWidgetContainer})),r.a.createElement(de.a,{style:qe.introductionContainer,className:this.state.data.introduction?null:"hidden"},r.a.createElement($.a,{style:qe.popupIntroduction,variant:"body2",color:"textSecondary",component:"p"},this.state.data.introduction)))}}]),t}(r.a.Component),Ge=(a(337),a(12)),Je=(a(115),a(174)),Qe=a(368),$e=a(433),Ke=a(434),Ye=a(435),Xe=a(436),et=a(74),tt=a(449),at=a(438),nt=a(437),rt=a(47),ot=a.n(rt),it=a(90),lt=Object(Je.a)(function(e){return{root:{width:"100%","& .MuiDropzoneArea-root":{minHeight:"100px",maxHeight:"200px"}},fileDetails:{marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0,fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},checkBoxContainer:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},inputLabel:{marginBottom:e.spacing(1)},dateInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},foormControl:{margin:e.spacing(3)},dropzone:{minHeight:"191px"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function st(e){var t=e.onSubmit,a=lt(),o=Object(n.useState)([]),i=Object(Ge.a)(o,2)[1],l=Object(n.useState)("rf"),s=Object(Ge.a)(l,2)[1],c=Object(n.useState)(!1),d=Object(Ge.a)(c,2),p=d[0],u=d[1],m=Object(n.useState)({rf:!1,svm:!1,knn:!1,aoiDataFiles:[],startDate:"2024-04-14",endDate:"2024-05-14",satelliteData:{sentinel1:!1,sentinel2:!1,landsat:!1},indexes:{vegetationIndexes:!1,brightnessIndexes:!1,moistureIndexes:!1},modelFeatures:{numberOfTrees:500,seed:1e-4,bagFraction:0},performanceIndicators:{rsquare:!1,rmse:!1,mse:!1,mae:!1,rpiq:!1}}),h=Object(Ge.a)(m,2),f=h[0],v=h[1],y=Object(n.useState)(!1),b=Object(Ge.a)(y,2),x=b[0],E=b[1],C=Object(n.useState)(0),w=Object(Ge.a)(C,2),S=w[0],k=w[1];Object(n.useEffect)(function(){var e;return x?e=setInterval(function(){k(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[x]);var L=function(e){return function(t,a){u(!!a&&e)}},I=function(e){var t=e.target,a=t.name,n=t.value,r=t.checked,o=t.type;v(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,"checkbox"===o||"radio"===o?r:n))}),"options"===a&&s(n)},O=function(){var e=Object(W.a)(z.a.mark(function e(){var a,n,r,o,i,l,s;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in e.prev=0,E(!0),k(0),(a=new FormData).append("aoiDataFiles",f.aoiDataFiles[0]),f.satelliteData)a.append(n,f.satelliteData[n]);for(r in f.indexes)a.append(r,f.indexes[r]);for(o in f.modelFeatures)a.append(o,f.modelFeatures[o]);for(i in f.performanceIndicators)a.append(i,f.performanceIndicators[i]);return console.log(a),e.next=12,fetch("http://localhost:5004/rusle",{method:"POST",body:a});case 12:return l=e.sent,e.next=15,l.json();case 15:(s=e.sent)&&(console.log("Data sent successfully",s),t(s),E(!1)),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(0),E(!1),console.error("Failed to send data",e.t0);case 23:case"end":return e.stop()}},e,null,[[0,19]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:a.root},r.a.createElement(tt.a,{expanded:"panel2"===p,onChange:L("panel2")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel2bh-content",id:"panel2bh-header"},r.a.createElement($.a,{className:a.heading},"Upload Files")),r.a.createElement(at.a,null,r.a.createElement(et.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(W.a)(z.a.mark(function e(t){var a,n,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(it.a)(t.target.result);case 3:a=e.sent,n=a.features.length>0?Object.keys(a.features[0].properties):[],r=n.filter(function(e){return"number"===typeof a.features[0].properties[e]}),i(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error processing shapefile",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}v(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest (AOI)",maxFileSize:5e6,filesLimit:1,getPreviewIcon:function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return r.a.createElement($e.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return r.a.createElement(Ke.a,n);case"application/pdf":return r.a.createElement(Ye.a,n);default:return r.a.createElement(Xe.a,n)}}}))),r.a.createElement(tt.a,{expanded:"panel3"===p,onChange:L("panel3")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel3bh-content",id:"panel3bh-header"},r.a.createElement($.a,{className:a.heading},"Dates")),r.a.createElement(at.a,null,r.a.createElement(pe.a,{container:!0,spacing:2},r.a.createElement(pe.a,{item:!0,xs:12,sm:10},r.a.createElement(Q.a,{label:"Start Date",type:"date",name:"startDate",value:f.startDate,onChange:I,className:a.dateInput,InputLabelProps:{shrink:!0}}),r.a.createElement(Q.a,{label:"End Date",type:"date",name:"endDate",value:f.endDate,onChange:I,className:a.dateInput,InputLabelProps:{shrink:!0}}))))),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement(g.a,{onClick:O,color:"primary",variant:"contained"},"Submit Data"),r.a.createElement(Qe.a,{className:a.backdrop,open:x},r.a.createElement(Z.a,{color:"inherit"}),r.a.createElement($.a,{variant:"h6",className:a.progressText},"Ejecutando el modelo... ",S,"s")))}var ct=Object(O.b)({palette:{primary:{main:Y.a.A200}}}),dt={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},rooot:{width:"100%"},heading:{fontSize:ct.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:ct.typography.pxToRem(15),color:ct.palette.text.secondary},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},pt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],expanded:!1},a.calculateSustainabilityIndex=function(){var e=1===a.state.Io?a.state.IoType:0,t=2.45*a.state.Ic+2.18*a.state.Ih+1.64*a.state.Ig+1.09*e+1*a.state.If;a.setState({sustainabilityIndex:t})},a.handleDecision=function(e){a.setState({decision:e})},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en ModelController:",e),f.emit("moveURL",a.state.url)},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a.processTemperatureData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Temperatura del Aire HC"};a.setState({temperatureData:[t],loading:!1})},a.processPrecipitationData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Precipitaci\xf3n"};a.setState({precipitationData:[t],loading:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openRusleControllerListener=f.addListener("openRusleController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var r=Object(Ge.a)(t.geometry.coordinates,2),o=r[0],i=r[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(o,",").concat(i,")/").concat(o,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(ze);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(o).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"setIc",value:function(e){this.setState({Ic:e})}},{key:"setIh",value:function(e){this.setState({Ih:e})}},{key:"setIg",value:function(e){this.setState({Ig:e})}},{key:"setIo",value:function(e){this.setState({Io:e})}},{key:"setIoType",value:function(e){this.setState({IoType:e})}},{key:"setIf",value:function(e){this.setState({If:e})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openRusleControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:ct},r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:dt.root},r.a.createElement(de.a,{style:dt.header},r.a.createElement($.a,{variant:"h5",className:dt.title},"RUSLE Modelling"),"\xa0\xa0",r.a.createElement(st,{onSubmit:this.handleDataSubmit}),r.a.createElement(L.a,{style:dt.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(r.a.Component),ut=a(370),mt=a(439),ht=a(440),gt=a(446),ft=Object(Je.a)(function(e){return{root:{width:"100%","& .MuiDropzoneArea-root":{minHeight:"100px",maxHeight:"200px"}},fileDetails:{marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0,fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},checkBoxContainer:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},inputLabel:{marginBottom:e.spacing(1)},dateInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},foormControl:{margin:e.spacing(3)},dropzone:{minHeight:"191px"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function vt(e){var t=e.onSubmit,a=ft(),o=Object(n.useState)([]),i=Object(Ge.a)(o,2),l=i[0],s=i[1],c=Object(n.useState)(""),d=Object(Ge.a)(c,2),p=d[0],u=d[1],m=Object(n.useState)("rf"),h=Object(Ge.a)(m,2),f=h[0],v=h[1],y=Object(n.useState)(!1),b=Object(Ge.a)(y,2),x=b[0],E=b[1],C=Object(n.useState)({rf:!1,svm:!1,knn:!1,soilDataFiles:[],aoiDataFiles:[],startDate:"2024-04-14",endDate:"2024-05-14",satelliteData:{sentinel1:!1,sentinel2:!1,landsat:!1},indexes:{vegetationIndexes:!1,brightnessIndexes:!1,moistureIndexes:!1},modelFeatures:{numberOfTrees:500,seed:1e-4,bagFraction:0},performanceIndicators:{rsquare:!1,rmse:!1,mse:!1,mae:!1,rpiq:!1}}),w=Object(Ge.a)(C,2),S=w[0],k=w[1],L=Object(n.useState)(!1),I=Object(Ge.a)(L,2),O=I[0],j=I[1],D=Object(n.useState)(0),T=Object(Ge.a)(D,2),R=T[0],P=T[1];Object(n.useEffect)(function(){var e;return O?e=setInterval(function(){P(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[O]);var B=function(e){return function(t,a){E(!!a&&e)}},_=function(e){var t=e.target,a=t.name,n=t.value,r=t.checked,o=t.type;k(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,"checkbox"===o||"radio"===o?r:n))}),"options"===a&&v(n)},A=function(){var e=Object(W.a)(z.a.mark(function e(){var a,n,r,o,i,l,s;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in e.prev=0,j(!0),P(0),(a=new FormData).append("soilDataFiles",S.soilDataFiles[0]),a.append("aoiDataFiles",S.aoiDataFiles[0]),S.satelliteData)a.append(n,S.satelliteData[n]);for(r in S.indexes)a.append(r,S.indexes[r]);for(o in S.modelFeatures)a.append(o,S.modelFeatures[o]);for(i in S.performanceIndicators)a.append(i,S.performanceIndicators[i]);return console.log(a),e.next=13,fetch("http://localhost:5004/soil_organic_prediction",{method:"POST",body:a});case 13:return l=e.sent,e.next=16,l.json();case 16:(s=e.sent)&&(console.log("Data sent successfully",s),t(s),j(!1)),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),j(!1),console.error("Failed to send data",e.t0);case 24:case"end":return e.stop()}},e,null,[[0,20]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:a.root},r.a.createElement(tt.a,{expanded:"panel1"===x,onChange:B("panel1")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},r.a.createElement($.a,{className:a.heading},"Machine learning algorithm")),r.a.createElement(at.a,null,r.a.createElement(ut.a,{className:a.checkBoxContainer},r.a.createElement(mt.a,{row:!0,name:"options",value:f,onChange:_},r.a.createElement(ht.a,{value:"rf",control:r.a.createElement(gt.a,null),label:"RF"}),r.a.createElement(ht.a,{value:"svm",control:r.a.createElement(gt.a,null),label:"SVM"}),r.a.createElement(ht.a,{value:"knn",control:r.a.createElement(gt.a,null),label:"KNN"}))))),r.a.createElement(tt.a,{expanded:"panel2"===x,onChange:B("panel2")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel2bh-content",id:"panel2bh-header"},r.a.createElement($.a,{className:a.heading},"Upload Files")),r.a.createElement(at.a,null,r.a.createElement(et.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(W.a)(z.a.mark(function e(t){var a,n,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(it.a)(t.target.result);case 3:a=e.sent,n=a.features.length>0?Object.keys(a.features[0].properties):[],r=n.filter(function(e){return"number"===typeof a.features[0].properties[e]}),s(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error processing shapefile",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}k(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest (AOI)",maxFileSize:5e6,filesLimit:1,getPreviewIcon:function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return r.a.createElement($e.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return r.a.createElement(Ke.a,n);case"application/pdf":return r.a.createElement(Ye.a,n);default:return r.a.createElement(Xe.a,n)}}}))),l.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.a,{expanded:"panel6"===x,onChange:B("panel6")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel4bh-content",id:"panel4bh-header"},r.a.createElement($.a,{className:a.heading},"Variable to Estimate")),r.a.createElement(at.a,null,r.a.createElement(be.a,{fullWidth:!0},r.a.createElement(xe.a,{id:"numeric-column-selector-label"},"Select Value to Estimate"),r.a.createElement(Ee.a,{labelId:"numeric-column-selector-label",id:"numeric-column-selector",value:p,label:"Select Numeric Column",onChange:function(e){u(e.target.value)}},l.map(function(e,t){return r.a.createElement(Ce.a,{key:t,value:e},e)})))))):r.a.createElement(r.a.Fragment,null),r.a.createElement(tt.a,{expanded:"panel3"===x,onChange:B("panel3")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel3bh-content",id:"panel3bh-header"},r.a.createElement($.a,{className:a.heading},"Spectral Information Data")),r.a.createElement(at.a,null,r.a.createElement(pe.a,{container:!0,spacing:2},r.a.createElement(pe.a,{item:!0,xs:12,sm:10},r.a.createElement(Q.a,{label:"Start Date",type:"date",name:"startDate",value:S.startDate,onChange:_,className:a.dateInput,InputLabelProps:{shrink:!0}}),r.a.createElement(Q.a,{label:"End Date",type:"date",name:"endDate",value:S.endDate,onChange:_,className:a.dateInput,InputLabelProps:{shrink:!0}}))),r.a.createElement(pe.a,{container:!0,spacing:2},r.a.createElement(pe.a,{item:!0,xs:12,sm:6},r.a.createElement(be.a,{component:"fieldset",className:a.formControl},r.a.createElement($.a,{variant:"subtitle1"},"Satellite Data:"),r.a.createElement(ut.a,null,r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"sentinel1",checked:S.satelliteData.sentinel1,onChange:_}),label:"Sentinel-1"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"sentinel2",checked:S.satelliteData.sentinel2,onChange:_}),label:"Sentinel-2"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"landsat",checked:S.satelliteData.landsat,onChange:_}),label:"Landsat"})))),r.a.createElement(pe.a,{item:!0,xs:12,sm:6},r.a.createElement(be.a,{component:"fieldset",className:a.formControl},r.a.createElement($.a,{variant:"subtitle1"},"Indexes:"),r.a.createElement(ut.a,null,r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"vegetationIndexes",checked:S.indexes.vegetationIndexes,onChange:_}),label:"Vegetation indexes"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"brightnessIndexes",checked:S.indexes.brightnessIndexes,onChange:_}),label:"Brightness indexes"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"moistureIndexes",checked:S.indexes.moistureIndexes,onChange:_}),label:"Moisture indexes"}))))))),r.a.createElement(tt.a,{expanded:"panel4"===x,onChange:B("panel4")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel4bh-content",id:"panel4bh-header"},r.a.createElement($.a,{className:a.heading},"Model features")),r.a.createElement(at.a,null,function(){switch(f){case"rf":return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement($.a,{className:a.inputLabel},"Number of trees"),r.a.createElement(Q.a,{className:a.formControl,variant:"outlined",name:"numberOfTrees",value:S.modelFeatures.numberOfTrees,onChange:_,type:"number"})),"\xa0\xa0",r.a.createElement("div",null,r.a.createElement($.a,{className:a.inputLabel},"Seed"),r.a.createElement(Q.a,{className:a.formControl,variant:"outlined",name:"seed",value:S.modelFeatures.seed,onChange:_,type:"number",inputProps:{step:"0.0001"}})),"\xa0\xa0",r.a.createElement("div",null,r.a.createElement($.a,{className:a.inputLabel},"Bag fraction"),r.a.createElement(Q.a,{className:a.formControl,variant:"outlined",name:"bagFraction",value:S.modelFeatures.bagFraction,onChange:_,type:"number"})));case"svm":case"knn":return r.a.createElement(r.a.Fragment,null);default:return null}}())),r.a.createElement(tt.a,{expanded:"panel5"===x,onChange:B("panel5")},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel4bh-content",id:"panel4bh-header"},r.a.createElement($.a,{className:a.heading},"Model Performance Indicators")),r.a.createElement(at.a,null,r.a.createElement(ut.a,{className:a.checkBoxContainer},r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"rsquare",checked:S.performanceIndicators.rsquare,onChange:_}),label:"R SQUARE"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"rmse",checked:S.performanceIndicators.rmse,onChange:_}),label:"RMSE"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"mse",checked:S.performanceIndicators.mse,onChange:_}),label:"MSE"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"mae",checked:S.performanceIndicators.mae,onChange:_}),label:"MAE"}),r.a.createElement(ht.a,{control:r.a.createElement(q.a,{name:"rpiq",checked:S.performanceIndicators.rpiq,onChange:_}),label:"RPIQ"})))),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement(g.a,{onClick:A,color:"primary",variant:"contained"},"Submit Data"),r.a.createElement(Qe.a,{className:a.backdrop,open:O},r.a.createElement(Z.a,{color:"inherit"}),r.a.createElement($.a,{variant:"h6",className:a.progressText},"Ejecutando el modelo... ",R,"s")))}var yt=Object(O.b)({palette:{primary:{main:Y.a.A200}}}),bt={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},rooot:{width:"100%"},heading:{fontSize:yt.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:yt.typography.pxToRem(15),color:yt.palette.text.secondary},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},xt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0},a.handleDecision=function(e){a.setState({decision:e})},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en ModelController:",e),f.emit("moveURL",a.state.url)},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.calculateSustainabilityIndex=function(){var e=a.state,t=e.Ic,n=e.Ih,r=e.Ig,o=e.Io,i=e.If,l=e.IoType,s=2.45*t+2.18*n+1.64*r+1.09*(1===o?l:0)+1*i;a.setState({sustainabilityIndex:s})},a.handleSubmitClick=function(){f.emit("removeTempPoint"),a.setState({submitting:!0})},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a.processTemperatureData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Temperatura del Aire HC"};a.setState({temperatureData:[t],loading:!1})},a.processPrecipitationData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Precipitaci\xf3n"};a.setState({precipitationData:[t],loading:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openSocControllerListener=f.addListener("openSocController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var r=Object(Ge.a)(t.geometry.coordinates,2),o=r[0],i=r[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(o,",").concat(i,")/").concat(o,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(ze);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(o).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"setIc",value:function(e){this.setState({Ic:e})}},{key:"setIh",value:function(e){this.setState({Ih:e})}},{key:"setIg",value:function(e){this.setState({Ig:e})}},{key:"setIo",value:function(e){this.setState({Io:e})}},{key:"setIoType",value:function(e){this.setState({IoType:e})}},{key:"setIf",value:function(e){this.setState({If:e})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openSocControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:yt},r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:bt.root},r.a.createElement(de.a,{style:bt.header},r.a.createElement($.a,{variant:"h5",className:bt.title},"Soil Organic Carbon Predictor"),"\xa0\xa0",r.a.createElement(vt,{onSubmit:this.handleDataSubmit}),r.a.createElement(L.a,{style:bt.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(r.a.Component),Et=Object(Je.a)(function(e){return{root:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},dateInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function Ct(e){var t=e.onSubmit,a=Et(),o=Object(n.useState)(!1),i=Object(Ge.a)(o,2),l=i[0],s=i[1],c=Object(n.useState)({startDate:"2024-04-14",endDate:"2024-05-14",indexType:"NDVI",aoiDataFiles:[]}),d=Object(Ge.a)(c,2),p=d[0],u=d[1],m=Object(n.useState)(!1),h=Object(Ge.a)(m,2),f=h[0],v=h[1],y=Object(n.useState)(0),b=Object(Ge.a)(y,2),x=b[0],E=b[1];Object(n.useEffect)(function(){var e;return f?e=setInterval(function(){E(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[f]);var C,w=function(e){var t=e.target,a=t.name,n=t.value;u(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,n))})},S=function(){var e=Object(W.a)(z.a.mark(function e(){var a,n,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(!0),E(0),(a=new FormData).append("aoiDataFiles",p.aoiDataFiles[0]),a.append("indexType",p.indexType),a.append("startDate",p.startDate),a.append("endDate",p.endDate),e.next=10,fetch("http://localhost:5004/vegetation_index_change_inspector",{method:"POST",body:a});case 10:return n=e.sent,e.next=13,n.json();case 13:if(r=e.sent,console.log(r),!r){e.next=20;break}return console.log("Data sent successfully",r),t(r),v(!1),e.abrupt("return",!0);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),console.error("Failed to send data",e.t0);case 25:case"end":return e.stop()}},e,null,[[0,22]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:a.root},r.a.createElement(tt.a,{expanded:"panel1"===l,onChange:(C="panel1",function(e,t){s(!!t&&C)})},r.a.createElement(nt.a,{expandIcon:r.a.createElement(ot.a,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},r.a.createElement($.a,{className:a.heading},"Choose a veg index")),r.a.createElement(at.a,null,r.a.createElement(et.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(W.a)(z.a.mark(function e(t){return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}u(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest (AOI)",maxFileSize:5e6,filesLimit:1,getPreviewIcon:function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return r.a.createElement($e.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return r.a.createElement(Ke.a,n);case"application/pdf":return r.a.createElement(Ye.a,n);default:return r.a.createElement(Xe.a,n)}}})),r.a.createElement(at.a,null,r.a.createElement(be.a,{className:a.formControl},r.a.createElement(Q.a,{label:"Start Date",type:"date",name:"startDate",value:p.startDate,onChange:w,className:a.dateInput,InputLabelProps:{shrink:!0}}),r.a.createElement(Q.a,{label:"End Date",type:"date",name:"endDate",value:p.endDate,onChange:w,className:a.dateInput,InputLabelProps:{shrink:!0}}),r.a.createElement(xe.a,{id:"index-type-label"},"Index Type"),r.a.createElement(Ee.a,{labelId:"index-type-label",id:"index-type-select",value:p.indexType,onChange:w,name:"indexType"},r.a.createElement(Ce.a,{value:"NDVI"},"NDVI"),r.a.createElement(Ce.a,{value:"EVI"},"EVI"),r.a.createElement(Ce.a,{value:"SAVI"},"SAVI"))))),r.a.createElement(g.a,{onClick:S,color:"primary",variant:"contained"},"Submit Data"),r.a.createElement(Qe.a,{className:a.backdrop,open:f},r.a.createElement(Z.a,{color:"inherit"}),r.a.createElement($.a,{variant:"h6",className:a.progressText},"Ejecutando el modelo... ",x,"s")))}var wt=Object(O.b)({palette:{primary:{main:Y.a.A200}}}),St={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},rooot:{width:"100%"},heading:{fontSize:wt.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:wt.typography.pxToRem(15),color:wt.palette.text.secondary},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},kt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en BandController:",e),f.emit("moveURL",a.state.url)},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openVegInspectorControllerListener=f.addListener("openVegInspectorController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var r=Object(Ge.a)(t.geometry.coordinates,2),o=r[0],i=r[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(o,",").concat(i,")/").concat(o,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(ze);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(o).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openBandControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:wt},r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:St.root},r.a.createElement(de.a,{style:St.header},r.a.createElement($.a,{variant:"h5",className:St.title},"Vegetation Index Change Inspector"),"\xa0\xa0",r.a.createElement(Ct,{onSubmit:this.handleDataSubmit}),r.a.createElement(L.a,{style:St.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(r.a.Component),Lt=a(444),It=a(457),Ot=a(441),jt=a(448),Dt=a(207),Tt=a.n(Dt),Rt=["Select your AOI","Choose variable","Select data range"],Pt=Object(Je.a)(function(e){return{root:{width:"100%","& .MuiDropzoneArea-root":{minHeight:"100px",maxHeight:"200px"}},fileDetails:{marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0,fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},checkBoxContainer:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},inputLabel:{marginBottom:e.spacing(1)},dateInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},foormControl:{margin:e.spacing(3)},dropzone:{minHeight:"191px"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function Bt(e){e.onSubmit;var t=Pt(),a=Object(n.useState)([]),o=Object(Ge.a)(a,2)[1],i=Object(n.useState)(0),l=Object(Ge.a)(i,2),s=l[0],c=l[1],d=Object(n.useState)([]),p=Object(Ge.a)(d,2),u=p[0],m=p[1],h=Object(n.useState)({startDate:"",endDate:"",equipmentType:"",dataType:""}),f=Object(Ge.a)(h,2),v=f[0],y=f[1],b=Object(n.useState)(!1),x=Object(Ge.a)(b,2),E=x[0],C=x[1],w=Object(n.useState)(0),S=Object(Ge.a)(w,2),k=S[0],L=S[1],I=Object(n.useState)(!1),O=Object(Ge.a)(I,2),j=O[0],D=O[1],T=function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return r.a.createElement($e.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return r.a.createElement(Ke.a,n);case"application/pdf":return r.a.createElement(Ye.a,n);default:return r.a.createElement(Xe.a,n)}},R=function(e){y(Object(ve.a)({},v,Object(fe.a)({},e.target.name,e.target.value)))},P=function(e){console.log(e.sort(function(e,t){return e.Date-t.Date}));var t=e.sort(function(e,t){return e.Date-t.Date}),a={type:"scatter",mode:"lines",x:t.map(function(e){return new Date(e.Date)}),y:t.map(function(e){return e.Value}),name:v.dataType};m([a])},B={title:v.dataType+" Visualization",xaxis:{title:"Date",type:"date"},yaxis:{title:v.dataType+" Content"}},_=function(){var e=Object(W.a)(z.a.mark(function e(){var t,a,n;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),L(0),(t=new FormData).append("aoiDataFiles",v.aoiDataFiles[0]),t.append("varType",v.dataType),e.next=8,fetch("http://localhost:5004/spatiotemporal_analysis",{method:"POST",body:t});case 8:return a=e.sent,D(!0),e.next=12,a.json();case 12:n=e.sent,console.log(n),n&&n.output&&(console.log(n.output[0]),console.log(t),P(n.output)),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Failed to fetch data: ",e.t0);case 20:return e.prev=20,C(!1),e.finish(20);case 23:case"end":return e.stop()}},e,null,[[0,17,20,23]])}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){var e;return E?e=setInterval(function(){L(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[E]);return r.a.createElement(Lt.a,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},!j&&r.a.createElement(It.a,{activeStep:s,sx:{width:"80%",marginBottom:2}},Rt.map(function(e){return r.a.createElement(Ot.a,{key:e},r.a.createElement(jt.a,null,e))})),r.a.createElement("div",null,s!==Rt.length||E?r.a.createElement(r.a.Fragment,null,function(e){switch(e){case 0:return r.a.createElement(Lt.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},r.a.createElement(et.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(W.a)(z.a.mark(function e(t){var a,n,r;return z.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(it.a)(t.target.result);case 3:a=e.sent,n=a.features.length>0?Object.keys(a.features[0].properties):[],r=n.filter(function(e){return"number"===typeof a.features[0].properties[e]}),o(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error processing shapefile",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}y(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest (AOI)",maxFileSize:5e6,filesLimit:1,getPreviewIcon:T}));case 1:return r.a.createElement(Lt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},r.a.createElement(xe.a,{id:"data-type-label"},"Data Type"),r.a.createElement(Ee.a,{labelId:"data-type-label",id:"data-type-select",value:v.dataType,onChange:R,name:"dataType",sx:{width:200,margin:1}},r.a.createElement(Ce.a,{value:"NDVI"},"NDVI"),r.a.createElement(Ce.a,{value:"EVI"},"EVI"),r.a.createElement(Ce.a,{value:"TSAVI"},"TSAVI"),r.a.createElement(Ce.a,{value:"MSI"},"MSI"),r.a.createElement(Ce.a,{value:"PRECIPT"},"PRECIPT"),r.a.createElement(Ce.a,{value:"TREE_COVER"},"TREE COVER %"),r.a.createElement(Ce.a,{value:"ABVGRND_CARBON"},"ABVGRND CARBON")));case 2:return r.a.createElement(Lt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},r.a.createElement(xe.a,{id:"data-type-label"},"Data Range"),r.a.createElement(Q.a,{label:"Start Date",type:"date",name:"startDate",value:v.startDate,onChange:R,InputLabelProps:{shrink:!0},sx:{margin:1}}),r.a.createElement(Q.a,{label:"End Date",type:"date",name:"endDate",value:v.endDate,onChange:R,InputLabelProps:{shrink:!0},sx:{margin:1}}))}}(s),r.a.createElement(Lt.a,{sx:{display:"flex",flexDirection:"row",pt:2,alignItems:"center",justifyContent:"center"}},r.a.createElement(g.a,{disabled:0===s,onClick:function(){c(function(e){return e-1})}},"Back"),r.a.createElement(g.a,{onClick:function(){s===Rt.length-1&&_(),c(function(e){return e+1})}},s===Rt.length-1?"Finish":"Next")),E&&r.a.createElement(Qe.a,{className:t.backdrop,open:E},r.a.createElement(Z.a,{color:"inherit"}),r.a.createElement($.a,{variant:"h6",className:t.progressText},"Ejecutando la consulta... ",k,"s"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{onClick:function(){c(0),y({startDate:"",endDate:"",equipmentType:"",dataType:""}),m([]),D(!1)}},"Reset"),r.a.createElement(Tt.a,{data:u,layout:B}))))}var _t=Object(O.b)({palette:{primary:{main:Y.a.A200}}}),At={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},rooot:{width:"100%"},heading:{fontSize:_t.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:_t.typography.pxToRem(15),color:_t.palette.text.secondary},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},Ft=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en BandController:",e),f.emit("moveURL",a.state.url)},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openSpatioTemporalAnalysisControllerListener=f.addListener("openSpatioTemporalAnalysisController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var r=Object(Ge.a)(t.geometry.coordinates,2),o=r[0],i=r[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(o,",").concat(i,")/").concat(o,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(ze);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(o).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openSpatioTemporalAnalysisControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return r.a.createElement(j.a,{theme:_t},r.a.createElement(J.a,{direction:"left",in:this.state.open},r.a.createElement(ce.a,{style:At.root},r.a.createElement(de.a,{style:At.header},r.a.createElement($.a,{variant:"h5",className:At.title},"Spatiotemporal Analysis"),"\xa0\xa0",r.a.createElement(Bt,null),r.a.createElement(L.a,{style:At.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},r.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(r.a.Component),Mt=function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(h.SnackbarProvider,{maxSnack:3},r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement(C,null),r.a.createElement(B,null),r.a.createElement(N,null),r.a.createElement(le,null),r.a.createElement(se,null),r.a.createElement(he,null),r.a.createElement(Oe,null),r.a.createElement(xt,null),r.a.createElement(pt,null),r.a.createElement(kt,null),r.a.createElement(Ft,null),r.a.createElement(Ze,null),r.a.createElement(He,null)))}}]),t}(r.a.Component),Nt=function(){return r.a.createElement(l.a,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:"/",component:Mt})))},Ut=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function zt(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(function(){return r.a.createElement(Nt,null)},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Ut?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):zt(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):zt(t,e)})}}()}},[[232,1,2]]]);
//# sourceMappingURL=main.fe7e3267.chunk.js.map